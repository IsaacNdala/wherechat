{"version":3,"file":"js/103.c9bedcce.js","mappings":"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","sources":["webpack://wherechat/./src/components/MessageComponent.vue","webpack://wherechat/./src/components/MessageComponent.vue?c9e4"],"sourcesContent":["<template>\n  <div id=\"message-component\" class=\"message-component\">\n    <nav class=\"message-component__nav\">\n      <a @click=\"this.$router.go(-1)\"><i class=\"fi fi-rr-arrow-small-left d-flex\"></i\n      ></a>\n      <div class=\"message-component__nav__img-container border\">\n        <img :src=\"serverDomain + userInChat.imageUrl\" alt=\"\" />\n      </div>\n      <span class=\"message-component__nav__username\">{{ userInChat.firstName }} {{ userInChat.lastName }}</span>\n    </nav>\n\n    <div class=\"message-component__message-form-container\">\n      <form @submit.prevent=\"sendMessage\">\n        <div class=\"d-flex\">\n          <textarea\n            v-model=\"messageForm.content\"\n            class=\"form-control\"\n            placeholder=\"Write a message\"\n            rows=\"1\"\n          ></textarea>\n          <input v-model=\"messageForm.to\" type=\"hidden\" />\n          <button class=\"btn btn-primary\">\n            <i class=\"fi fi-rr-paper-plane d-flex\"></i>\n          </button>\n        </div>\n      </form>\n    </div>\n\n    <div class=\"message-component__body\">\n      <div class=\"message-component__body__head\">\n        <div @click=\"scrollBottom\" class=\"message-component__body__head__img-container border\">\n          <img :src=\"serverDomain + userInChat.imageUrl\" alt=\"\" />\n        </div>\n        <div class=\"message-component__body__head__info\">\n          <span class=\"message-component__body__head__info__username\"\n            >{{ userInChat.firstName }} {{ userInChat.lastName }}</span\n          >\n        </div>\n      </div>\n      <div v-for=\"message in newMessages\" :key=\"message._id\" class=\"message-component__body__message\">\n        <div class=\"d-flex\" :class=\"{'flex-row-reverse': message.me }\">\n          <div v-if=\"!message.me\" class=\"message-component__body__message__img-container border\">\n            <img :src=\"serverDomain + message.imageUrl\" alt=\"\" />\n          </div>\n          <div \n            class=\"message-component__body__message__content\"\n            :class=\"{'message-component__body__message__content__you': message.me }\"\n          >{{ message.content }}</div>\n        </div>\n        <span \n          class=\"message-component__body__message__date\" \n          :class=\"{'message-component__body__message__date__you': message.me }\">\n          {{ message.date }}\n        </span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport store from '@/store'\nimport openSocket from 'socket.io-client'\nimport { mapState } from 'vuex'\nexport default {\n  name: \"MessageComponent\",\n  data() {\n    return {\n      messages: [],\n      messageForm: {\n        content: '',\n        to: this.$route.params.userId\n      },\n      userInChat: {}\n    }\n  },computed: {\n    ...mapState(['user', 'serverDomain']),\n    newMessages() {\n      const messages = [...this.messages]\n      messages.forEach(message => {\n        if(message.from._id === store.state.user.id) {\n          message.me = true\n          message.imageUrl = message.from.imageUrl\n        }\n\n        if(message.from._id === this.messageForm.to) {\n          message.me = false\n          message.imageUrl = message.from.imageUrl\n        }\n        \n        message.date = new Date(message.createdAt).toDateString()\n      })\n      return messages\n    }\n  },\n  watch: {\n    '$route'(to) {\n      this.messageForm.to = to.params.userId\n      this.fetchMessages()\n    },\n  },\n  methods: {\n    // Method to auto scroll de message page\n    scrollBottom() {\n      let messageComponent = document.getElementById('message-component')\n      messageComponent.scrollTo(0, messageComponent.scrollHeight)\n    },\n    // Method to send message\n    async sendMessage() {\n      let res\n      if(this.messageForm.content !== '') {\n        res = await axios.post(store.state.serverDomain + 'message/send-message', this.messageForm, { \n          headers: {\n            Authorization: `Bearer ${store.state.token}`\n          }\n        })\n      }\n\n      if(res) {\n        this.messageForm.content = ''\n      }\n    },\n    // Method to get the messages on chat\n    async fetchMessages() {\n      try {\n        const res = await axios.get(store.state.serverDomain + 'message/view-messages/' + this.messageForm.to, {\n          headers: {\n            Authorization: `Bearer ${store.state.token}`\n          }\n        })\n\n        this.messages = res.data.messages\n\n        if(res) {\n          this.fetchUser()\n        }\n      } catch (error) {\n        if(error.response && error.response.status === 401) {\n          this.$router.push('/login')\n        }\n      }\n    },\n    // Method to get user information on chat\n    async fetchUser() {\n      try {\n        const res = await axios.get(store.state.serverDomain + 'user/get-user/' + this.messageForm.to, { \n          headers: {\n            Authorization: `Bearer ${store.state.token}`\n          }\n        })\n\n        this.userInChat = res.data.user\n      } catch (error) {\n        if(error.response && error.response.status === 401) {\n          this.$router.push('/login')\n        }\n      }\n    }\n  },\n  created() {\n    this.fetchMessages()\n  },\n  mounted() {\n    if(document.getElementById('message-component')) {\n      console.log('mounted')\n    }\n    const socket = openSocket(store.state.serverDomain)\n    socket.on('messages', data => {\n      if(data.action === 'sent') {\n        this.messages.push(data.message)\n        this.scrollBottom()\n      }\n    })\n  },\n  updated() {\n    this.scrollBottom()\n  }\n};\n</script>\n\n<style lang=\"scss\">\n.message-component::-webkit-scrollbar {\n  width: 20px;\n}\n\n.message-component {\n  position: relative;\n  position: absolute;\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  width: 100%;\n  background-color: white;\n  overflow: auto;\n  z-index: 200;\n  padding-top: 6rem;\n  padding-bottom: 8rem;\n  max-height: 100vh;\n  overflow: auto;\n\n  .message-component__nav {\n    position: absolute;\n    position: fixed;\n    top: 0;\n    left: 0;\n    display: flex;\n    align-items: center;\n    width: 100%;\n    height: 4.5rem;\n    background-color: white;\n    border-bottom: 1px solid #d0d2d4;\n\n    .message-component__nav__img-container {\n      margin-right: 0.5rem;\n    }\n\n    a {\n      padding: 1rem;\n      padding-right: 0.5rem;\n      i {\n        font-size: 1.5rem;\n      }\n    }\n\n    .message-component__nav__img-container {\n      height: 3rem;\n      width: 3rem;\n      overflow: hidden;\n      border-radius: 50%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n\n      img {\n        width: 3rem;\n      }\n    }\n\n    .message-component__nav__username {\n      font-weight: bold;\n    }\n  }\n\n  .message-component__message-form-container {\n    padding: 1rem;\n    height: 5rem;\n    width: 100%;\n    background-color: white;\n    position: absolute;\n    position: fixed;\n    bottom: 0;\n    right: 0;\n    border-top: 1px solid #d0d2d4;\n\n    textarea {\n      border-radius: 2rem;\n      padding-top: 0.7rem;\n      padding-bottom: 0.7rem;\n\n      &:focus {\n        box-shadow: none;\n        border-color: #ced4da;\n      }\n    }\n\n    @media (min-width: 541px) {\n      textarea {\n        width: 30rem;\n      }\n    }\n\n    button {\n      padding: 1rem;\n      border-radius: 50%;\n      margin-left: 0.5rem;\n\n      &:focus {\n        box-shadow: none;\n        border-color: #0d6efd;\n        background-color: #0d6efd;\n      }\n    }\n  }\n\n  .message-component__body {\n    .message-component__body__head {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      padding-bottom: 2rem;\n\n      .message-component__body__head__img-container {\n        height: 6rem;\n        width: 6rem;\n        overflow: hidden;\n        border-radius: 50%;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n\n        img {\n          max-width: 6rem;\n        }\n      }\n\n      .message-component__body__head__info {\n        margin-top: 0.5rem;\n        .message-component__body__head__info__username {\n          font-weight: bold;\n        }\n\n        .message-component__body__head__info__country {\n          margin-left: 0.3rem;\n          font-size: 0.7rem;\n          font-weight: bold;\n          color: #006aff;\n        }\n      }\n    }\n\n    .message-component__body__message {\n      display: flex;\n      padding: 1rem 0.8rem 0 0.8rem;\n      flex-direction: column;\n\n      .message-component__body__message__img-container {\n        height: 3rem;\n        width: 3rem;\n        overflow: hidden;\n        border-radius: 50%;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n\n        img {\n          width: 3rem;\n        }\n      }\n\n      .message-component__body__message__content {\n        margin-left: 0.5rem;\n        max-width: 12rem;\n        display: flex;\n        flex-direction: column;\n        border-radius: 0 1rem 1rem 1rem;\n        padding: 0.7rem;\n        background-color: #e4e6eb;\n        overflow-wrap: break-word;\n      }\n\n      @media (min-width: 440px) {\n        .message-component__body__message__content {\n          max-width: 20rem;\n        }\n      }\n\n      .message-component__body__message__content__you {\n        background-color: #006aff;\n        border-radius: 1rem 0 1rem 1rem;\n        color: white;\n        margin-left: 0;\n        margin-right: 0.5rem;\n      }\n\n      .message-component__body__message__date {\n        margin-top: 0.2rem;\n        text-align: center;\n        font-size: 0.8rem;\n        color: #65676b;\n        text-align: center;\n      }\n\n      @media (min-width: 992px) {\n        .message-component__body__message__date {\n          text-align: left;\n          margin-left: 5rem;\n        }\n\n        .message-component__body__message__date__you {\n          text-align: right;\n          margin-right: 7rem;\n        }\n      }\n    }\n  }\n}\n\n@media (min-width: 768px) {\n  .message-component {\n    width: 60%;\n    right: 0;\n    z-index: 50;\n    padding-bottom: 12rem; \n\n    .message-component__message-form-container {\n      width: 60%;\n      bottom: 5rem;\n    }\n  }\n}\n</style>","import { render } from \"./MessageComponent.vue?vue&type=template&id=5db5fb54\"\nimport script from \"./MessageComponent.vue?vue&type=script&lang=js\"\nexport * from \"./MessageComponent.vue?vue&type=script&lang=js\"\n\nimport \"./MessageComponent.vue?vue&type=style&index=0&id=5db5fb54&lang=scss\"\n\nimport exportComponent from \"/Users/isaacndala/Projects/wherechat/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["id","class","_createElementVNode","_hoisted_3","_createElementBlock","onClick","$router","go","src","_ctx","$data","imageUrl","alt","_toDisplayString","firstName","lastName","onSubmit","$options","content","$event","placeholder","rows","to","type","_hoisted_10","_Fragment","_renderList","message","key","_id","me","date","name","data","messages","messageForm","this","$route","params","userId","userInChat","computed","mapState","newMessages","forEach","from","store","Date","createdAt","toDateString","watch","fetchMessages","methods","scrollBottom","messageComponent","document","getElementById","scrollTo","scrollHeight","async","res","axios","headers","Authorization","fetchUser","error","response","status","push","user","created","mounted","console","log","socket","openSocket","on","action","updated","__exports__","render"],"sourceRoot":""}